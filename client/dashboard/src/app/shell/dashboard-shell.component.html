<div class="shell" (click)="closeUserMenu()">
  <aside class="sidebar" [class.sidebar--collapsed]="sidebarCollapsed()" (click)="$event.stopPropagation()">
    <div class="sidebar__top">
      <button type="button" class="icon-btn" (click)="toggleSidebar()" aria-label="Toggle menu">
        <span class="burger"></span>
      </button>

      @if (!sidebarCollapsed()) {
        <div class="brand">
          <div class="brand__logo">TP</div>
          <div class="brand__text">
            <div class="brand__title">Tourism Platform</div>
            <div class="brand__subtitle">Admin dashboard</div>
          </div>
        </div>
      }
    </div>

    <nav class="nav">
      @for (item of menuItems; track item.basePath) {
        <button type="button" class="nav__item" (click)="openMenu(item)">
          <span class="nav__icon" aria-hidden="true">{{ item.icon }}</span>

          @if (!sidebarCollapsed()) {
            <span class="nav__label">{{ item.label }}</span>
          }
        </button>
      }
    </nav>
  </aside>

  <div class="main">
    <header class="topbar" (click)="$event.stopPropagation()">
      <div class="topbar__title">Dashboard</div>

      <div class="user">
        <button type="button" class="user__btn" (click)="toggleUserMenu()">
          <span class="user__avatar">{{ initials() }}</span>
          <span class="user__name">{{ displayName() }}</span>
          <span class="user__chev"></span>
        </button>

        @if (userMenuOpen()) {
          <div class="user-menu">
            <button type="button" class="user-menu__item" (click)="changePassword()">Change password</button>
            <button type="button" class="user-menu__item danger" (click)="logout()">Logout</button>
          </div>
        }
      </div>
    </header>

    <section class="tabs">
      <div class="tabs__track">
        @for (tab of tabs.tabs(); track tab.id) {
          <button
            type="button"
            class="tab"
            [class.tab--active]="tabs.activeTabId() === tab.id"
            (click)="activate(tab)"
          >
            <span class="tab__title">{{ tab.title || 'Tab' }}</span>

            @if (!tab.pinned) {
              <span class="tab__close" (click)="close(tab, $event)" aria-hidden="true">Ã—</span>
            }
          </button>
        }
      </div>
    </section>

    <main class="content">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>
