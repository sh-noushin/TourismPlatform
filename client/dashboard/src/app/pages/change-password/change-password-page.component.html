<div class="dialog-shell" (click)="$event.stopPropagation()">
  <div class="glass-panel">
    <header class="header">
      <h3>{{ 'CHANGE_PASSWORD_PAGE.TITLE' | translate }}</h3>
    </header>

    <form [formGroup]="form" (ngSubmit)="submit()" class="form">
      <label class="field">
        <span>{{ 'CHANGE_PASSWORD_PAGE.CURRENT_PASSWORD' | translate }}</span>
        <input
          type="password"
          formControlName="currentPassword"
          placeholder="••••••"
          [class.invalid]="currentPassword.invalid && currentPassword.touched"
        />
        @if (currentPassword.touched && currentPassword.hasError('required')) {
          <small>
            {{ 'CHANGE_PASSWORD_PAGE.ERROR_MIN_LENGTH' | translate }}
          </small>
        }
      </label>

      <label class="field">
        <span>{{ 'CHANGE_PASSWORD_PAGE.NEW_PASSWORD' | translate }}</span>
        <input
          type="password"
          formControlName="newPassword"
          placeholder="••••••"
          [class.invalid]="newPassword.invalid && newPassword.touched"
        />
        @if (newPassword.touched && newPassword.hasError('minlength')) {
          <small>
            {{ 'CHANGE_PASSWORD_PAGE.ERROR_MIN_LENGTH' | translate }}
          </small>
        }
        @if (newPassword.touched && newPassword.hasError('pattern')) {
          <small>
            {{ 'CHANGE_PASSWORD_PAGE.ERROR_PATTERN' | translate }}
          </small>
        }
      </label>

      <label class="field">
        <span>{{ 'CHANGE_PASSWORD_PAGE.CONFIRM_PASSWORD' | translate }}</span>
        <input
          type="password"
          formControlName="confirmPassword"
          placeholder="••••••"
          [class.invalid]="form.hasError('passwordMismatch') && confirmPassword.touched"
        />
        @if (form.touched && form.hasError('passwordMismatch')) {
          <small>
            {{ 'CHANGE_PASSWORD_PAGE.ERROR_MISMATCH' | translate }}
          </small>
        }
      </label>

      <section class="actions">
        <button type="button" class="btn ghost" (click)="close()" [disabled]="busy">
          {{ 'CHANGE_PASSWORD_PAGE.CANCEL' | translate }}
        </button>
        <button type="submit" class="btn primary" [disabled]="form.invalid || busy">
          {{ 'CHANGE_PASSWORD_PAGE.SUBMIT' | translate }}
        </button>
        @if (feedback?.type === 'success') {
          <p class="feedback success">{{ feedback?.message }}</p>
        }
        @if (feedback?.type === 'error') {
          <p class="feedback error">{{ feedback?.message }}</p>
        }
      </section>
    </form>
  </div>
</div>
